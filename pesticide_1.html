
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; Defra Pesticide Testing, Data Analysis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/ONS-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Defra Pesticide Testing, Data Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Defra Pesticide Testing, Data Analysis
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ThomasHSimm/Pesticide/master?urlpath=tree/docs/pesticide_1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ThomasHSimm/Pesticide"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ThomasHSimm/Pesticide/issues/new?title=Issue%20on%20page%20%2Fpesticide_1.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/pesticide_1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="simple visible nav section-nav flex-column">
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><no title></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="simple visible nav section-nav flex-column">
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import pandas as pd
import ezodf
from modify_dfs import *
import os
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">ezodf</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">modify_dfs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">os</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;modify_dfs&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
s_fname = &quot;C:\\Users\simmt\Code1\Pesticide\data\August_2022_rolling_reports.ods&quot;
# doc = ezodf.opendoc(s_fname)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>folder_path = &#39;C:\\Users\simmt\Code1\Pesticide\Pesticide-main\data_files&#39;
file_path = []
for x in os.listdir(folder_path):
    file_path.append(os.path.join(folder_path,x) )

    
doc = ezodf.opendoc(file_path[0])
# get last sheet
sheet = doc.sheets[-4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_dict = {}
print(sheet.name)
for i, row in enumerate(sheet.rows()):
#     row is a list of cells
# #     assume the header is on the first row
    if i == 2:
    # columns as lists in a dictionary
        df_dict = {cell.value:[] for cell in row}
df_dict
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TinTomatoes_BNA
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;1606/2016&#39;: [],
 &#39;2016-04-15T00:00:00&#39;: [],
 &#39;Sweet Harvest Peeled Plum Tomatoes&#39;: [],
 &#39;Italy&#39;: [],
 &#39;Aldi&#39;: [],
 &#39;Newbridge Hill, Louth LN11 0NQ&#39;: [],
 &#39;Aldi &#39;: [],
 &#39;Aldi Stores Ltd PO Box 26, Atherstone, Warwickshire CV9 2SH&#39;: [],
 &#39;None were detected above the set RL&#39;: [],
 None: []}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>data_sheet = []
for i,row in enumerate(sheet.rows()):
    if i==0:
        column_names = [cell.value for cell in row]
        print(column_names)
    else:
        data_sheet.append( [cell.value for cell in row] )
ddf = pd.DataFrame(data_sheet)

ddf.columns = column_names

ddf
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Sample ID&#39;, &#39;Date of Sampling&#39;, &#39;Description&#39;, &#39;Country of Origin&#39;, &#39;Retail Outlet&#39;, &#39;Address&#39;, &#39;Brand Name&#39;, &#39;Packer / Manufacturer&#39;, &#39;Pesticide residues found in mg/kg (MRL)&#39;, None]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Retail Outlet</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
      <th>None</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1605/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Sweet Harvest Chunky Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Aldi</td>
      <td>Newbridge Hill, Louth LN11 0JT</td>
      <td>Aldi</td>
      <td>Aldi Stores Ltd PO Box 26, Atherstone, Warwick...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1606/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Sweet Harvest Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Aldi</td>
      <td>Newbridge Hill, Louth LN11 0NQ</td>
      <td>Aldi</td>
      <td>Aldi Stores Ltd PO Box 26, Atherstone, Warwick...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1752/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Chunky Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Aldi</td>
      <td>Walsall Road, Cannock WS11 0EA</td>
      <td>Aldi</td>
      <td>Aldi Stores Ltd PO Box 26, Atherstone, Warwick...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1753/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Aldi</td>
      <td>Walsall Road, Cannock WS11 0EA</td>
      <td>Aldi</td>
      <td>Aldi Stores Ltd PO Box 26, Atherstone, Warwick...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0400/2016</td>
      <td>2016-05-10T00:00:00</td>
      <td>Cherry Tomatoes</td>
      <td>Italy</td>
      <td>Asda</td>
      <td>Avon Road, Cannock WS11 1LH</td>
      <td>Napolina</td>
      <td>Napolina Ltd Royal Liver Building, Pier Head, ...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1740/2016</td>
      <td>2016-05-06T00:00:00</td>
      <td>Smart Price Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Asda</td>
      <td>Avon Road, Cannock WS11 1LH</td>
      <td>Asda</td>
      <td>Asda Stores Ltd Leeds LS11 5AD</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1622/2016 Organic</td>
      <td>2016-04-16T00:00:00</td>
      <td>Tarantella Organic Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Co-op</td>
      <td>Northgate, Louth LN11 0LT</td>
      <td>Tarantella</td>
      <td>Community Foods Ltd Brent Terrace, London NW2 1LT</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1638/2016</td>
      <td>2016-04-16T00:00:00</td>
      <td>Italian Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Co-op</td>
      <td>Northgate, Louth LN11 0LT</td>
      <td>Co-op</td>
      <td>Co-operative Group Ltd Manchester M60 0AG</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1607/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Italian Plum Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Morrisons</td>
      <td>Wm Morrison PLC Gain Lane, Bradford BD3 7DL</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1608/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Italian Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Morrisons</td>
      <td>Wm Morrison PLC Gain Lane, Bradford BD3 7DL</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1609/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Tomato Fillets</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Cirio</td>
      <td>Dawood Exports Ltd 5, Buroh Lane, 09-01, Singa...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1610/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Cook Italian</td>
      <td>LDH La Doria Ltd Huntingdon, Cambridgeshire PE...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1611/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Napolina</td>
      <td>Napolina Ltd Royal Liver Building, Pier Head, ...</td>
      <td>flonicamid (sum) 0.01 (MRL = 0.3)</td>
      <td>None</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1612/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Peeld Plum Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Napolina</td>
      <td>Napolina Ltd Royal Liver Building, Pier Head, ...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1613/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Cook Italian</td>
      <td>LDH La Doria Ltd Parsons Green, St Ives, Cambr...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1614/2016</td>
      <td>2016-04-15T00:00:00</td>
      <td>Tuscan Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Morrisons</td>
      <td>150 Eastgate, Louth LN11 9AB</td>
      <td>Cirio</td>
      <td>Conserve Italia Soc Co-op Agricola Via P Poggi...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1741/2016 Organic</td>
      <td>2016-05-05T00:00:00</td>
      <td>SO Organic Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd London EC1N 2HT</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1742/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Napolina</td>
      <td>Napolina Ltd Royal Liver Building, Pier Head, ...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1743/2016 Organic</td>
      <td>2016-05-05T00:00:00</td>
      <td>SO Organic Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd London EC1N 2HT</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1744/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Peeled Plum Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Napolina</td>
      <td>Napolina Ltd Royal Liver Building, Pier Head, ...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1745/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Plum Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd London EC1N 2HT</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1747/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Cirio</td>
      <td>Conserve Italia Soc Co-op Agricola Via P Poggi...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1748/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>Voyager Drive, Cannock WS11 8XD</td>
      <td>Cook Italian</td>
      <td>LDH La Doria Ltd Parsons Green, St Ives, Cambr...</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1751/2016</td>
      <td>2016-05-05T00:00:00</td>
      <td>Chopped Tomatoes</td>
      <td>Italy</td>
      <td>Tesco</td>
      <td>Heath Way, Cannock WS12 3YY</td>
      <td>Tesco</td>
      <td>Tesco Stores Ltd Cheshunt EN8 9SL</td>
      <td>None were detected above the set RL</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def import_ods(fname):
    doc = ezodf.opendoc(s_fname)
    for i, sheet in enumerate(doc.sheets):
        if i!=0: #ignore 1st sheet
            product = sheet.name
            print(product)
            
            df_new =import_ods_inner(sheet)
            df_new.columns = df_new.columns.str.strip()
            try:
                df = pd.concat([df,df_new])
            except:
                df = df_new
                
    return df
            
def import_ods_inner(sheet):
    df_dict = {}
    for i, row in enumerate(sheet.rows()):
    #     row is a list of cells
# #     assume the header is on the first row
        if i == 1:
        # columns as lists in a dictionary
            df_dict = {cell.value:[] for cell in row}

    # create index for the column headers
    for i,row in enumerate(sheet.rows()):
        if i == 0:
            continue
        elif i == 1:
            col_index = [cell.value for cell in row]
            continue
        for j,cell in enumerate(row):
            df_dict[col_index[j]].append(cell.value)
            
    # delete none column
    try:
        del df_dict[None]
    except:
        pass
    # and convert to a DataFrame
    df = pd.DataFrame(df_dict)
    
    # fill based on previous values    
    df.fillna(method=&#39;ffill&#39;, inplace=True)

    return df
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df = import_ods(s_fname)

modify_df(df)
# import re
# def extract_pcode(x):  
#     regexp = r&#39;([A-Za-z]+[0-9]+\s[0-9]+[A-Za-z]+$)&#39;
#     try:
#         return re.findall(regexp,x)[0]
#     except:
#         return 0
# eg_pc = &#39;hdwhck ss1 2wg&#39;
# regexp = r&#39;([A-Za-z]+[0-9]+\s[0-9]+[A-Za-z]+$)&#39;
                      
                      
# # df = extract_pcode(df,&#39;Address&#39;)
# df[&#39;Address&#39;].apply(extract_pcode)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Beans_with_Pods_(GB)
Grapes_(GB)
Potatoes_(GB)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>date_of_sampling</th>
      <th>description</th>
      <th>country_of_origin</th>
      <th>sampling_point</th>
      <th>address</th>
      <th>brand_name</th>
      <th>packer_/_manufacturer_/_importer</th>
      <th>pesticide_residues_found_in_mg/kg_(mrl)</th>
      <th>address_postcode</th>
      <th>packer__postcode</th>
      <th>chem_name</th>
      <th>amount_detected</th>
      <th>mrl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3729/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Extra Fine Beans</td>
      <td>Guatemala</td>
      <td>Tesco</td>
      <td>19-20 Boundary Road, Brighton, Portslade BN41 1GB</td>
      <td>Tesco</td>
      <td>Tesco Stores Ltd Tesco House, Shire Park, Kest...</td>
      <td>tebuconazole 0.03 (MRL = 2)</td>
      <td>BN41 1GB</td>
      <td>AL7 1GA</td>
      <td>tebuconazole</td>
      <td>0.03</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3729/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Extra Fine Beans</td>
      <td>Guatemala</td>
      <td>Tesco</td>
      <td>19-20 Boundary Road, Brighton, Portslade BN41 1GB</td>
      <td>Tesco</td>
      <td>Tesco Stores Ltd Tesco House, Shire Park, Kest...</td>
      <td>fluopyram 0.06 (MRL = 1)</td>
      <td>BN41 1GB</td>
      <td>AL7 1GA</td>
      <td>fluopyram</td>
      <td>0.06</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5951/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Extra Fine Green Beans</td>
      <td>Kenya</td>
      <td>Aldi</td>
      <td>9-10 Boulevard Retail Park, Aberdeen AB11 5EJ</td>
      <td>Specially Selected</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>cyantraniliprole 0.02 (MRL = 1.5)</td>
      <td>AB11 5EJ</td>
      <td>CV9 2SH</td>
      <td>cyantraniliprole</td>
      <td>0.02</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1941/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Green Beans</td>
      <td>UK</td>
      <td>Asda</td>
      <td>Jockey Lane, Monks Cross Drive, Huntington, Yo...</td>
      <td>Asda</td>
      <td>ASDA Stores Ltd Great Wilson Street, Leeds LS1...</td>
      <td>n/a</td>
      <td>YO32 9LF</td>
      <td>LS11 5AD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1975/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Green Beans</td>
      <td>UK</td>
      <td>Marks &amp; Spencer</td>
      <td>George Lane, South Woodford E18 1AY</td>
      <td>Marks &amp; Spencer</td>
      <td>Marks &amp; Spencer Plc PO Box 3339. Chester CH99 9QS</td>
      <td>flonicamid (sum) 0.1 (MRL = 1.5)</td>
      <td>E18 1AY</td>
      <td>CH99 9QS</td>
      <td>flonicamid (sum)</td>
      <td>0.1</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1901/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Trimmed Beans</td>
      <td>Kenya</td>
      <td>Morrisons</td>
      <td>Sutton Road, Maidstone ME15 9NN</td>
      <td>Morrisons</td>
      <td>Wm Morrison Supermarkets Plc 71 Gain Lane, Bra...</td>
      <td>azoxystrobin 0.02 (MRL = 3)</td>
      <td>ME15 9NN</td>
      <td>BD3 7DL</td>
      <td>azoxystrobin</td>
      <td>0.02</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1946/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Runner Beans</td>
      <td>UK</td>
      <td>Sainsburys</td>
      <td>30 Mere Green Road B75 5BT</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd 33 Holborn, London...</td>
      <td>n/a</td>
      <td>B75 5BT</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1946/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Runner Beans</td>
      <td>UK</td>
      <td>Sainsburys</td>
      <td>30 Mere Green Road B75 5BT</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd 33 Holborn, London...</td>
      <td>n/a</td>
      <td>B75 5BT</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2003/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Ralli Wonky Red Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>9-10 Boulevard Retail Park, Aberdeen AB11 5EJ</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>spirotetramat (sum) 0.05 (MRL = 2)</td>
      <td>AB11 5EJ</td>
      <td>CV9 2SH</td>
      <td>spirotetramat (sum)</td>
      <td>0.05</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2003/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Ralli Wonky Red Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>9-10 Boulevard Retail Park, Aberdeen AB11 5EJ</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>trifloxystrobin 0.1 (MRL = 3)</td>
      <td>AB11 5EJ</td>
      <td>CV9 2SH</td>
      <td>trifloxystrobin</td>
      <td>0.1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6126/2022</td>
      <td>2022-08-09T00:00:00</td>
      <td>ARRA 15 Seedless White Grapes</td>
      <td>Morocco</td>
      <td>Aldi</td>
      <td>Faverdale North, Faverdale Industrial Estate, ...</td>
      <td>Nature's Pick</td>
      <td>Elite Harvest Maroc Morocco</td>
      <td>azoxystrobin 0.02 (MRL = 3)</td>
      <td>DL3 0UW</td>
      <td>0</td>
      <td>azoxystrobin</td>
      <td>0.02</td>
      <td>3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1253/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Tawny Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>metalaxyl (sum) 0.02 (MRL = 2)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>metalaxyl (sum)</td>
      <td>0.02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1253/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Tawny Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>boscalid 0.03 (MRL = 5)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>boscalid</td>
      <td>0.03</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1253/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Tawny Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>ethephon 0.8 (MRL = 1)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>ethephon</td>
      <td>0.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1253/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Tawny Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>fluopyram 0.2 (MRL = 1.5)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>fluopyram</td>
      <td>0.2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1258/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Superior Seedless Green Grapes</td>
      <td>Italy</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>spiroxamine 0.03 (MRL = 0.6)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>spiroxamine</td>
      <td>0.03</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1258/2022</td>
      <td>2022-08-10T00:00:00</td>
      <td>Superior Seedless Green Grapes</td>
      <td>Italy</td>
      <td>Asda</td>
      <td>Erith CDC, Isis Reach, Norman Road, Belvedere ...</td>
      <td>Asda</td>
      <td>IPL Ltd  ME9 7TT</td>
      <td>acetamiprid 0.01 (MRL = 0.5)</td>
      <td>DA17 6JY</td>
      <td>ME9 7TT</td>
      <td>acetamiprid</td>
      <td>0.01</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1951/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Seedless Red Grapes</td>
      <td>Egypt</td>
      <td>Asda</td>
      <td>Jockey Lane, Monks Cross Drive, Huntington, Yo...</td>
      <td>Asda</td>
      <td>ASDA Stores Ltd Great Wilson Street, Leeds LS1...</td>
      <td>cyprodinil 0.03 (MRL = 3)</td>
      <td>YO32 9LF</td>
      <td>LS11 5AD</td>
      <td>cyprodinil</td>
      <td>0.03</td>
      <td>3</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1951/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Seedless Red Grapes</td>
      <td>Egypt</td>
      <td>Asda</td>
      <td>Jockey Lane, Monks Cross Drive, Huntington, Yo...</td>
      <td>Asda</td>
      <td>ASDA Stores Ltd Great Wilson Street, Leeds LS1...</td>
      <td>azoxystrobin 0.03 (MRL = 3)</td>
      <td>YO32 9LF</td>
      <td>LS11 5AD</td>
      <td>azoxystrobin</td>
      <td>0.03</td>
      <td>3</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1951/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Seedless Red Grapes</td>
      <td>Egypt</td>
      <td>Asda</td>
      <td>Jockey Lane, Monks Cross Drive, Huntington, Yo...</td>
      <td>Asda</td>
      <td>ASDA Stores Ltd Great Wilson Street, Leeds LS1...</td>
      <td>ethephon 0.08 (MRL = 1)</td>
      <td>YO32 9LF</td>
      <td>LS11 5AD</td>
      <td>ethephon</td>
      <td>0.08</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>6155/2022</td>
      <td>2022-08-22T00:00:00</td>
      <td>Premium Thompson Seedless Grapes</td>
      <td>Greece</td>
      <td>George Perry Ltd</td>
      <td>Birmingham Wholesale Market, Noble Way B6 7EU</td>
      <td>None stated</td>
      <td>Koufozisis SA Cretan Root Ano Archanes. Herakl...</td>
      <td>spirotetramat (sum) 0.01 (MRL = 2)</td>
      <td>B6 7EU</td>
      <td>0</td>
      <td>spirotetramat (sum)</td>
      <td>0.01</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6155/2022</td>
      <td>2022-08-22T00:00:00</td>
      <td>Premium Thompson Seedless Grapes</td>
      <td>Greece</td>
      <td>George Perry Ltd</td>
      <td>Birmingham Wholesale Market, Noble Way B6 7EU</td>
      <td>None stated</td>
      <td>Koufozisis SA Cretan Root Ano Archanes. Herakl...</td>
      <td>chlorantraniliprole 0.1 (MRL = 1)</td>
      <td>B6 7EU</td>
      <td>0</td>
      <td>chlorantraniliprole</td>
      <td>0.1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>6155/2022</td>
      <td>2022-08-22T00:00:00</td>
      <td>Premium Thompson Seedless Grapes</td>
      <td>Greece</td>
      <td>George Perry Ltd</td>
      <td>Birmingham Wholesale Market, Noble Way B6 7EU</td>
      <td>None stated</td>
      <td>Koufozisis SA Cretan Root Ano Archanes. Herakl...</td>
      <td>etofenprox 0.02 (MRL = 4*)</td>
      <td>B6 7EU</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1227/2022 Organic</td>
      <td>2022-08-23T00:00:00</td>
      <td>ARRA 30 Grapes</td>
      <td>Italy</td>
      <td>Langridge Organic Products Ltd</td>
      <td>Unit 6 Felthambrook Industrial Estate, Feltham...</td>
      <td>None stated</td>
      <td>O.P. Orlofrutticola Jonica C. delama di Pozzo ...</td>
      <td>n/a</td>
      <td>TW13 7DU</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3731/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Ralli Red Seedless Grapes</td>
      <td>Spain</td>
      <td>Lidl</td>
      <td>Goldstone Retail Park, Newton Road, Hove BN3 7PN</td>
      <td>Oaklands</td>
      <td>Lidl GT. Britain Ltd Lidl House, 14 Kingston R...</td>
      <td>boscalid 0.4 (MRL = 5)</td>
      <td>BN3 7PN</td>
      <td>KT5 9NU</td>
      <td>boscalid</td>
      <td>0.4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>25</th>
      <td>3731/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Ralli Red Seedless Grapes</td>
      <td>Spain</td>
      <td>Lidl</td>
      <td>Goldstone Retail Park, Newton Road, Hove BN3 7PN</td>
      <td>Oaklands</td>
      <td>Lidl GT. Britain Ltd Lidl House, 14 Kingston R...</td>
      <td>spirotetramat (sum) 0.05 (MRL = 2)</td>
      <td>BN3 7PN</td>
      <td>KT5 9NU</td>
      <td>spirotetramat (sum)</td>
      <td>0.05</td>
      <td>2</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3731/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Ralli Red Seedless Grapes</td>
      <td>Spain</td>
      <td>Lidl</td>
      <td>Goldstone Retail Park, Newton Road, Hove BN3 7PN</td>
      <td>Oaklands</td>
      <td>Lidl GT. Britain Ltd Lidl House, 14 Kingston R...</td>
      <td>trifloxystrobin 0.07 (MRL = 3)</td>
      <td>BN3 7PN</td>
      <td>KT5 9NU</td>
      <td>trifloxystrobin</td>
      <td>0.07</td>
      <td>3</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0656/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Produce Depot, Bristol Road, Bridgwater TA6 4AT</td>
      <td>Morrisons</td>
      <td>Cutler Bradford BD4 9LR</td>
      <td>deltamethrin 0.03 (MRL = 0.2)</td>
      <td>TA6 4AT</td>
      <td>BD4 9LR</td>
      <td>deltamethrin</td>
      <td>0.03</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0656/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Produce Depot, Bristol Road, Bridgwater TA6 4AT</td>
      <td>Morrisons</td>
      <td>Cutler Bradford BD4 9LR</td>
      <td>cyprodinil 0.02 (MRL = 3)</td>
      <td>TA6 4AT</td>
      <td>BD4 9LR</td>
      <td>cyprodinil</td>
      <td>0.02</td>
      <td>3</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0656/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Produce Depot, Bristol Road, Bridgwater TA6 4AT</td>
      <td>Morrisons</td>
      <td>Cutler Bradford BD4 9LR</td>
      <td>spirotetramat (sum) 0.07 (MRL = 2)</td>
      <td>TA6 4AT</td>
      <td>BD4 9LR</td>
      <td>spirotetramat (sum)</td>
      <td>0.07</td>
      <td>2</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0656/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Produce Depot, Bristol Road, Bridgwater TA6 4AT</td>
      <td>Morrisons</td>
      <td>Cutler Bradford BD4 9LR</td>
      <td>fluopyram 0.04 (MRL = 1.5)</td>
      <td>TA6 4AT</td>
      <td>BD4 9LR</td>
      <td>fluopyram</td>
      <td>0.04</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0656/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Produce Depot, Bristol Road, Bridgwater TA6 4AT</td>
      <td>Morrisons</td>
      <td>Cutler Bradford BD4 9LR</td>
      <td>ethephon 0.4 (MRL = 1)</td>
      <td>TA6 4AT</td>
      <td>BD4 9LR</td>
      <td>ethephon</td>
      <td>0.4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1903/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Sutton Road, Maidstone ME15 9NN</td>
      <td>Morrisons</td>
      <td>Wm Morrison Supermarkets Plc 71 Gain Lane, Bra...</td>
      <td>metalaxyl (sum) 0.02 (MRL = 2)</td>
      <td>ME15 9NN</td>
      <td>BD3 7DL</td>
      <td>metalaxyl (sum)</td>
      <td>0.02</td>
      <td>2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1903/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Sweet Celebration Seedless Red Grapes</td>
      <td>Spain</td>
      <td>Morrisons</td>
      <td>Sutton Road, Maidstone ME15 9NN</td>
      <td>Morrisons</td>
      <td>Wm Morrison Supermarkets Plc 71 Gain Lane, Bra...</td>
      <td>fluopyram 0.02 (MRL = 1.5)</td>
      <td>ME15 9NN</td>
      <td>BD3 7DL</td>
      <td>fluopyram</td>
      <td>0.02</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1262/2022</td>
      <td>2022-08-16T00:00:00</td>
      <td>Midnight Beauty Black Grapes</td>
      <td>Egypt</td>
      <td>Reynolds Catering Supplies Ltd</td>
      <td>National Distribution Centre, Britannia Road E...</td>
      <td>None stated</td>
      <td>Pico Modern Agriculture Co. Shagaret Eldor Str...</td>
      <td>trifloxystrobin 0.01 (MRL = 3)</td>
      <td>EN8 7RQ</td>
      <td>0</td>
      <td>trifloxystrobin</td>
      <td>0.01</td>
      <td>3</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1262/2022</td>
      <td>2022-08-16T00:00:00</td>
      <td>Midnight Beauty Black Grapes</td>
      <td>Egypt</td>
      <td>Reynolds Catering Supplies Ltd</td>
      <td>National Distribution Centre, Britannia Road E...</td>
      <td>None stated</td>
      <td>Pico Modern Agriculture Co. Shagaret Eldor Str...</td>
      <td>ethephon 0.08 (MRL = 1)</td>
      <td>EN8 7RQ</td>
      <td>0</td>
      <td>ethephon</td>
      <td>0.08</td>
      <td>1</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1262/2022</td>
      <td>2022-08-16T00:00:00</td>
      <td>Midnight Beauty Black Grapes</td>
      <td>Egypt</td>
      <td>Reynolds Catering Supplies Ltd</td>
      <td>National Distribution Centre, Britannia Road E...</td>
      <td>None stated</td>
      <td>Pico Modern Agriculture Co. Shagaret Eldor Str...</td>
      <td>fenhexamid 0.08 (MRL = 15)</td>
      <td>EN8 7RQ</td>
      <td>0</td>
      <td>fenhexamid</td>
      <td>0.08</td>
      <td>15</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1947/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Superior White Seedless Grapes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>30 Meregreen Road B75 5BT</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd 33 Holborn, London...</td>
      <td>spiroxamine 0.2 (MRL = 0.6)</td>
      <td>B75 5BT</td>
      <td>0</td>
      <td>spiroxamine</td>
      <td>0.2</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>38</th>
      <td>1947/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Superior White Seedless Grapes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>30 Meregreen Road B75 5BT</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd 33 Holborn, London...</td>
      <td>metrafenone 0.2 (MRL = 7)</td>
      <td>B75 5BT</td>
      <td>0</td>
      <td>metrafenone</td>
      <td>0.2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1947/2022</td>
      <td>2022-08-08T00:00:00</td>
      <td>Superior White Seedless Grapes</td>
      <td>Italy</td>
      <td>Sainsburys</td>
      <td>30 Meregreen Road B75 5BT</td>
      <td>Sainsburys</td>
      <td>Sainsburys Supermarkets Ltd 33 Holborn, London...</td>
      <td>metrafenone 0.2 (MRL = 7)</td>
      <td>B75 5BT</td>
      <td>0</td>
      <td>metrafenone</td>
      <td>0.2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1281/2022</td>
      <td>2022-07-27T00:00:00</td>
      <td>Lady Rosetta Ware Potatoes</td>
      <td>UK</td>
      <td>Kolak Snack Foods</td>
      <td>308-310 Elveden Road, London NW10 7ST</td>
      <td>None stated</td>
      <td>Mercian Ltd Unit 3 &amp; 4, The Barns, Highfield F...</td>
      <td>n/a</td>
      <td>NW10 7ST</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1282/2022</td>
      <td>2022-07-27T00:00:00</td>
      <td>Lady Rosetta Ware Potatoes</td>
      <td>UK</td>
      <td>Kolak Snack Foods</td>
      <td>308-310 Elveden Road, London NW10 7ST</td>
      <td>None stated</td>
      <td>Mercian Ltd Unit 3 &amp; 4, The Barns, Highfield F...</td>
      <td>n/a</td>
      <td>NW10 7ST</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1072/2022</td>
      <td>2022-08-02T00:00:00</td>
      <td>Markies Ware Potatoes</td>
      <td>UK</td>
      <td>Linwood Crops Ltd</td>
      <td>Linwood Farm, March PE15 0YG</td>
      <td>None stated</td>
      <td>PJ Lee and Sons Ltd High Flyer Farm, Ely CB7 4RA</td>
      <td>maleic hydrazide 18 (MRL = 60)</td>
      <td>PE15 0YG</td>
      <td>CB7 4RA</td>
      <td>maleic hydrazide</td>
      <td>18</td>
      <td>60</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0810/2022</td>
      <td>2022-07-27T00:00:00</td>
      <td>Maris Piper Ware Potatoes</td>
      <td>Israel</td>
      <td>London Gateway Port Ltd</td>
      <td>Stanford-Le-Hope, Essex SS17 9DY</td>
      <td>None stated</td>
      <td>Yapro Ltd Hanegev Building, Reem Junction DN S...</td>
      <td>n/a</td>
      <td>SS17 9DY</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0813/2022 Organic</td>
      <td>2022-07-27T00:00:00</td>
      <td>Organic Valor Ware Potatoes</td>
      <td>Israel</td>
      <td>London Gateway Port Ltd</td>
      <td>Stanford-Le-Hope, Essex SS17 9DY</td>
      <td>None stated</td>
      <td>Alumim Atzmona Potatoes Ltd Mivtachim DN Negev...</td>
      <td>n/a</td>
      <td>SS17 9DY</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0814/2022</td>
      <td>2022-07-27T00:00:00</td>
      <td>Soraya Ware Potatoes</td>
      <td>Israel</td>
      <td>London Gateway Port Ltd</td>
      <td>Stanford-Le-Hope, Essex SS17 9DY</td>
      <td>None stated</td>
      <td>Yapro Ltd Hanegev Building, Reem Junction DN S...</td>
      <td>n/a</td>
      <td>SS17 9DY</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0815/2022</td>
      <td>2022-07-27T00:00:00</td>
      <td>Maris Piper Ware Potatoes</td>
      <td>Israel</td>
      <td>London Gateway Port Ltd</td>
      <td>Stanford-Le-Hope, Essex SS17 9DY</td>
      <td>None stated</td>
      <td>Atzmona Mivtachim DN Negev, 85440, Israel</td>
      <td>n/a</td>
      <td>SS17 9DY</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0876/2022</td>
      <td>2022-08-25T00:00:00</td>
      <td>Accord Ware Potatoes</td>
      <td>UK</td>
      <td>PG Chips 2000 Ltd</td>
      <td>Elton Fold Mill, Harvey Street, Bury, Greater ...</td>
      <td>None stated</td>
      <td>JT Hopkins &amp; Sons Carsaig Farm, High Street, W...</td>
      <td>n/a</td>
      <td>BL8 1FZ</td>
      <td>ON9 2BT</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0873/2022</td>
      <td>2022-07-26T00:00:00</td>
      <td>Lady Rosetta Ware Potatoes</td>
      <td>UK</td>
      <td>Walkers Snack Foods Ltd</td>
      <td>Pennine Place, Pimbo, Skelmersdale WN8 9QF</td>
      <td>None stated</td>
      <td>Mercian Ltd Unit 3 &amp; 4, The Barns, Highfield F...</td>
      <td>n/a</td>
      <td>WN8 9QF</td>
      <td>SK11 9BN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0919/2022</td>
      <td>2022-07-26T00:00:00</td>
      <td>Lady Rosetta Ware Potatoes</td>
      <td>UK</td>
      <td>Walkers Snack Foods Ltd</td>
      <td>Pennine Place, Pimbo, Skelmersdale WN8 9QF</td>
      <td>None stated</td>
      <td>R.S. Cockerill (York) Ltd Providence Business ...</td>
      <td>n/a</td>
      <td>WN8 9QF</td>
      <td>YO19 5AE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0919/2022</td>
      <td>2022-07-26T00:00:00</td>
      <td>Lady Rosetta Ware Potatoes</td>
      <td>UK</td>
      <td>Walkers Snack Foods Ltd</td>
      <td>Pennine Place, Pimbo, Skelmersdale WN8 9QF</td>
      <td>None stated</td>
      <td>R.S. Cockerill (York) Ltd Providence Business ...</td>
      <td>n/a</td>
      <td>WN8 9QF</td>
      <td>YO19 5AE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># convert the first sheet to a pandas.DataFrame
sheet = doc.sheets[2]
product = sheet.name
df_dict = {}
for i, row in enumerate(sheet.rows()):
#     row is a list of cells
# #     assume the header is on the first row
    if i == 1:
        # columns as lists in a dictionary
#         print(cell.value)
#         df_dict.update({cell.value:[]})
        df_dict = {cell.value:[] for cell in row}
# df_dict

#         # create index for the column headers
for i,row in enumerate(sheet.rows()):
    if i == 0:
        continue
    elif i == 1:
        col_index = [cell.value for cell in row]
#         print([cell.value for cell in row])
        continue
    for j,cell in enumerate(row):
#         print (j,cell.value)
        df_dict[col_index[j]].append(cell.value)
# # # and convert to a DataFrame
try:
    del df_dict[None]
except:
    pass

df = pd.DataFrame(df_dict)


df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Sampling Point</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer / Importer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2493/2022</td>
      <td>2022-09-05T00:00:00</td>
      <td>Ivory White Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>Cameron Toll Shopping Centre, 6 Lady Road, Edi...</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>deltamethrin 0.02 (MRL = 0.2)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2493/2022</td>
      <td>2022-09-05T00:00:00</td>
      <td>Ivory White Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>Cameron Toll Shopping Centre, 6 Lady Road, Edi...</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>cyazofamid 0.02 (MRL = 2)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2493/2022</td>
      <td>2022-09-05T00:00:00</td>
      <td>Ivory White Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>Cameron Toll Shopping Centre, 6 Lady Road, Edi...</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>trifloxystrobin 0.03 (MRL = 3)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2493/2022</td>
      <td>2022-09-05T00:00:00</td>
      <td>Ivory White Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>Cameron Toll Shopping Centre, 6 Lady Road, Edi...</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>spirotetramat (sum) 0.02 (MRL = 2)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2493/2022</td>
      <td>2022-09-05T00:00:00</td>
      <td>Ivory White Grapes</td>
      <td>Spain</td>
      <td>Aldi</td>
      <td>Cameron Toll Shopping Centre, 6 Lady Road, Edi...</td>
      <td>Everyday Essentials</td>
      <td>Aldi Stores Ltd PO Box 26. Atherstone, Warwick...</td>
      <td>fluopyram 0.6 (MRL = 1.5)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[ (x, len(df_dict[x])) for x in df_dict]
# 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Sample ID&#39;, 34),
 (&#39;Date of Sampling&#39;, 34),
 (&#39;Description&#39;, 34),
 (&#39;Country of Origin&#39;, 34),
 (&#39;Sampling Point&#39;, 34),
 (&#39;Address&#39;, 34),
 (&#39;Brand Name&#39;, 34),
 (&#39;Packer / Manufacturer / Importer&#39;, 34),
 (&#39;Pesticide residues found in mg/kg (MRL)&#39;, 34)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>del df[None]
df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Sampling Point</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer / Importer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0753/2022</td>
      <td>2022-09-15T00:00:00</td>
      <td>Rooster Ware Potatoes</td>
      <td>UK</td>
      <td>Albert Bartlett Potatoes Ltd</td>
      <td>Kirton Holme, Kirton. Boston PE20 1TT</td>
      <td>None stated</td>
      <td></td>
      <td>None were detected above the set RL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0941/2022</td>
      <td>2022-08-24T00:00:00</td>
      <td>Sagitta Potatoes</td>
      <td>UK</td>
      <td>ARG Garrett</td>
      <td>New College Farm PE33 9AZ</td>
      <td>None stated</td>
      <td>Bradmount Foods 14 Dessert Martin Road BT45 7RB</td>
      <td>None were detected above the set RL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0940/2022</td>
      <td>2022-09-07T00:00:00</td>
      <td>Lanomma Potatoes</td>
      <td>UK</td>
      <td>Burgess Farm Produce</td>
      <td>East Bank Sutton Bridge, Spalding PE12 9YB</td>
      <td>None stated</td>
      <td>Robert Davies Wisbech</td>
      <td>None were detected above the set RL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1077/2022</td>
      <td>2022-09-12T00:00:00</td>
      <td>Challenger Ware Potatoes</td>
      <td>UK</td>
      <td>Lamb Weston Meijer</td>
      <td>Weasenham Lane, Wisbech PE13 2RN</td>
      <td>None stated</td>
      <td>Scott Newman</td>
      <td>fluopyram 0.01 (MRL = 0.15)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0793/2022</td>
      <td>2022-09-06T00:00:00</td>
      <td>Marfona Unwashed Potatoes</td>
      <td>UK</td>
      <td>Mack Wholesale</td>
      <td>40 Oriana Way, Southhampton SO16 0YU</td>
      <td>None stated</td>
      <td>PK Farms Willowdene Farm, Armstrong Lane, Bost...</td>
      <td>None were detected above the set RL</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.describe()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Sampling Point</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer / Importer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>10</td>
      <td>9</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>10</td>
      <td>1</td>
      <td>10</td>
      <td>4</td>
    </tr>
    <tr>
      <th>top</th>
      <td>0940/2022</td>
      <td>2022-08-31T00:00:00</td>
      <td>Sagitta Potatoes</td>
      <td>UK</td>
      <td>Mack Wholesale</td>
      <td>40 Oriana Way, Southhampton SO16 0YU</td>
      <td>None stated</td>
      <td>KP Crisps</td>
      <td>None were detected above the set RL</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.info()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11 entries, 0 to 10
Data columns (total 10 columns):
 #   Column                                   Non-Null Count  Dtype 
---  ------                                   --------------  ----- 
 0   Sample ID                                10 non-null     object
 1   Date of Sampling                         10 non-null     object
 2   Description                              10 non-null     object
 3   Country of Origin                        10 non-null     object
 4   Sampling Point                           10 non-null     object
 5   Address                                  10 non-null     object
 6   Brand Name                               10 non-null     object
 7   Packer / Manufacturer / Importer         10 non-null     object
 8   Pesticide residues found in mg/kg (MRL)  10 non-null     object
 9   None                                     0 non-null      object
dtypes: object(10)
memory usage: 1008.0+ bytes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>list(df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Sample ID&#39;,
 &#39;Date of Sampling&#39;,
 &#39;Description&#39;,
 &#39;Country of Origin&#39;,
 &#39;Sampling Point&#39;,
 &#39;Address&#39;,
 &#39;Brand Name&#39;,
 &#39;Packer / Manufacturer / Importer&#39;,
 &#39;Pesticide residues found in mg/kg (MRL)&#39;,
 None]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def modify_df(df):
    
    # remove null column at end
    del df[None]
    # fill na values
    df.fillna(method=&#39;ffill&#39;, inplace=True)
    
     
def extract_pcode(df,col):  
    regexp = r&#39;([A-Za-z]*[0-9]*\s[0-9]*[A-Za-z]*$)&#39;
    
    df[col+&#39;_post_code&#39;]=df[col].str.extract(regexp)
    return df
    
def extract_pesticide(df):
    
    df.replace({&#39;None were detected above the set RL&#39;: &#39;n/a&#39;}, regex=True, inplace=True)
    
    df2=df[&#39;pesticide_residues_found_in_mg/kg_(mrl)&#39;].str.extract(r&#39;(.*)\s(\d[\d.]*)\s+\(MRL\s*=\s*(\d[\d.]*)\)&#39;)

    df2.fillna(0, inplace=True)
    
    df2.rename(columns={0:&#39;chem_name&#39;,1:&#39;amount_detected&#39;,2:&#39;mrl&#39;},inplace=True)
   
    
    return df2
    
    
def rename_cols(df):
    renaming_dict = {
    old_name : new_name 
        for old_name,new_name 
        in zip(list(df),[new_name.lower().replace(&#39; &#39;,&#39;_&#39;) 
                         for new_name in list(df)])
    }

    df = df.rename(columns=renaming_dict)
    return df
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># # df[&#39;Address&#39;][0].str.extract(r&#39;)
# test_add = df[&#39;Address&#39;][0]
# print(test_add)
# import re

# regexp = r&#39;([A-Za-z]*[0-9]*\s[0-9]*[A-Za-z]*$)&#39;
# re.search(regexp, test_add)

# print(df.Address.head(10))

# dfpcode=df.Address.str.extract(regexp)

# len(df), len(dfpcode)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 

# df2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>index</th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Sampling Point</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer / Importer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
      <th>chem_name</th>
      <th>amount_detected</th>
      <th>mrl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>Dwarf Beans</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2704/2022</td>
      <td>20/09/2022</td>
      <td>Dwarf Beans</td>
      <td>UK</td>
      <td>WM Morrison Supermarkets PLC</td>
      <td>Dorcan House Site, Eldene Drive, Swindon SN3 3TX</td>
      <td>Morrisons</td>
      <td>Wm Morrisons Supermarkets PLC 71 Gain Lane, Br...</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>Fine Beans</td>
      <td>20/09/2022</td>
      <td>Dwarf Beans</td>
      <td>UK</td>
      <td>WM Morrison Supermarkets PLC</td>
      <td>Dorcan House Site, Eldene Drive, Swindon SN3 3TX</td>
      <td>Morrisons</td>
      <td>Wm Morrisons Supermarkets PLC 71 Gain Lane, Br...</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>2045/2022</td>
      <td>20/09/2022</td>
      <td>Trimmed Fine Beans</td>
      <td>Kenya</td>
      <td>Asda</td>
      <td>Highweek Street, Newton Abbot TQ12 1TG</td>
      <td>Asda</td>
      <td>ASDA Stores Ltd Great Wilson Street, Leeds LS1...</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>2701/2022</td>
      <td>20/09/2022</td>
      <td>Extra Fine Beans</td>
      <td>Kenya</td>
      <td>Tesco</td>
      <td>Askham Bar, Tadcaster Road, York YO24 1LW</td>
      <td>Tesco Finest</td>
      <td>Tesco Stores Ltd Tesco House, Shire Park, Kest...</td>
      <td>cyantraniliprole 0.04 (MRL = 1.5)</td>
      <td>cyantraniliprole</td>
      <td>0.04</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>68</th>
      <td>68</td>
      <td>6</td>
      <td>0792/2022</td>
      <td>2022-09-08T00:00:00</td>
      <td>Marfona Unwashed Potatoes</td>
      <td>UK</td>
      <td>Stoke Fruit Farm</td>
      <td>77 Havant Road, Hayling Island, Hampshire PO11...</td>
      <td>None stated</td>
      <td>Stoke Fruit Farm 77 Havant Road, Hayling Islan...</td>
      <td>maleic hydrazide 7.7 (MRL = 60)</td>
      <td>maleic hydrazide</td>
      <td>7.7</td>
      <td>60</td>
    </tr>
    <tr>
      <th>69</th>
      <td>69</td>
      <td>7</td>
      <td>0765/2022</td>
      <td>2022-09-14T00:00:00</td>
      <td>Sagitta Potatoes</td>
      <td>UK</td>
      <td>Total Produce Ltd.</td>
      <td>Callywith Gate Industrial Estate, Launceston R...</td>
      <td>None stated</td>
      <td>CS Duston &amp; Son Colwith Farm, Par, Cornwall</td>
      <td>maleic hydrazide 17 (MRL = 60)</td>
      <td>maleic hydrazide</td>
      <td>17</td>
      <td>60</td>
    </tr>
    <tr>
      <th>70</th>
      <td>70</td>
      <td>8</td>
      <td>0938/2022</td>
      <td>2022-09-01T00:00:00</td>
      <td>Marfona Ware Potatoes</td>
      <td>UK</td>
      <td>Tulipland Potatoes Ltd</td>
      <td>Fengate, Moulton Chapel PE12 0XL</td>
      <td>None stated</td>
      <td>Garden of Elveden</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>71</td>
      <td>9</td>
      <td>0833/2022</td>
      <td>2022-08-31T00:00:00</td>
      <td>Lady Rosetta</td>
      <td>England (UK)</td>
      <td>Tyrrells Crisps</td>
      <td>Tyrrells Court, Stretford Bridge, Leominster H...</td>
      <td>None stated</td>
      <td>KP Crisps</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>72</td>
      <td>10</td>
      <td>0833/2022</td>
      <td>2022-08-31T00:00:00</td>
      <td>Lady Rosetta</td>
      <td>England (UK)</td>
      <td>Tyrrells Crisps</td>
      <td>Tyrrells Court, Stretford Bridge, Leominster H...</td>
      <td>None stated</td>
      <td>KP Crisps</td>
      <td>None were detected above the set RL</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 14 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from modify_dfs import *

df2 = rename_cols(df)
df2 = extract_pesticide(df2)
df2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chem_name</th>
      <th>amount_detected</th>
      <th>mrl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cyantraniliprole</td>
      <td>0.04</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>68</th>
      <td>maleic hydrazide</td>
      <td>7.7</td>
      <td>60</td>
    </tr>
    <tr>
      <th>69</th>
      <td>maleic hydrazide</td>
      <td>17</td>
      <td>60</td>
    </tr>
    <tr>
      <th>70</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df2 = extract_pcode(df,&#39;Address&#39;)
df2.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sample ID</th>
      <th>Date of Sampling</th>
      <th>Description</th>
      <th>Country of Origin</th>
      <th>Sampling Point</th>
      <th>Address</th>
      <th>Brand Name</th>
      <th>Packer / Manufacturer / Importer</th>
      <th>Pesticide residues found in mg/kg (MRL)</th>
      <th>Address_post_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0753/2022</td>
      <td>2022-09-15T00:00:00</td>
      <td>Rooster Ware Potatoes</td>
      <td>UK</td>
      <td>Albert Bartlett Potatoes Ltd</td>
      <td>Kirton Holme, Kirton. Boston PE20 1TT</td>
      <td>None stated</td>
      <td></td>
      <td>None were detected above the set RL</td>
      <td>PE20 1TT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0941/2022</td>
      <td>2022-08-24T00:00:00</td>
      <td>Sagitta Potatoes</td>
      <td>UK</td>
      <td>ARG Garrett</td>
      <td>New College Farm PE33 9AZ</td>
      <td>None stated</td>
      <td>Bradmount Foods 14 Dessert Martin Road BT45 7RB</td>
      <td>None were detected above the set RL</td>
      <td>PE33 9AZ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0940/2022</td>
      <td>2022-09-07T00:00:00</td>
      <td>Lanomma Potatoes</td>
      <td>UK</td>
      <td>Burgess Farm Produce</td>
      <td>East Bank Sutton Bridge, Spalding PE12 9YB</td>
      <td>None stated</td>
      <td>Robert Davies Wisbech</td>
      <td>None were detected above the set RL</td>
      <td>PE12 9YB</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1077/2022</td>
      <td>2022-09-12T00:00:00</td>
      <td>Challenger Ware Potatoes</td>
      <td>UK</td>
      <td>Lamb Weston Meijer</td>
      <td>Weasenham Lane, Wisbech PE13 2RN</td>
      <td>None stated</td>
      <td>Scott Newman</td>
      <td>fluopyram 0.01 (MRL = 0.15)</td>
      <td>PE13 2RN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0793/2022</td>
      <td>2022-09-06T00:00:00</td>
      <td>Marfona Unwashed Potatoes</td>
      <td>UK</td>
      <td>Mack Wholesale</td>
      <td>40 Oriana Way, Southhampton SO16 0YU</td>
      <td>None stated</td>
      <td>PK Farms Willowdene Farm, Armstrong Lane, Bost...</td>
      <td>None were detected above the set RL</td>
      <td>SO16 0YU</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Thomas Simm<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>